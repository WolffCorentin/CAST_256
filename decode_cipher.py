from mode_operation import *

cipher = 0x58f50d85a063c40102217f7583565267ad1af4f9c27daedd3d27f4460b5dd80001f1d5afc9cf60eb6c064c410b6e051bf5929cb47911375e1d5f49cd68ebaa729fdb326ed2e42ccb633c73ecb7936da9f1626b6873cd7aae511974b982e29a07b919854b6590dd3929fd37f394ac3867b1b3c56197755d371ac7a65f308e744b54f7097c7b0f2bc56ec3708a1afcc1b467333399779f76517eb0fe8120db863dbc00f9df2267a318ee48b95dc84e7da9ee68baef8ef1a9f8538f759635f03edd6788c9a84cf7e438a931d4dec65a023c03b664e1f2aad5f572ff6a4b2863322e0bcdf6b873f7a03dcb404047eae59d63fb97d4c7d60e524eaa5cd6826656aae5f47ccc0348c26c153842b2d30e360f2213acb29cea0b58e2ba6a4e1a8ee773c3d62e8fba1c836a9e03ad542e1acf189cd4827b8393e23dab386a1fc12559f0dc5708ce4249b6bbd2923e6e245f17292f33eb8ae75bdccb3a61289421d79e46efb112f196d9421584b95906164e810d6e37cd1f2d04b6d196da3de55db21c20fc8eda82043d24fbc91122271e79b4d3146567cab21f7d0ca42465b76da78b08b9a52f40db43d2a78d9c0fc5a308c45fd5d981457e040e53a28c820976b538d3a5a8babd591a2b69fc2cd71e1cd375687f5ef82e1f08bda30e44a67e47630ccb85b40759d9880120ab1338aadeabfee3af60fc9eccf96adcb264640e9db88065a417fd359acd9d7bbe529a53ba8610e452508d2009ec27e2f7568dd3f2f1a080662d7d6525b18241e10b29ccf62ff54748ef05f4646539443c3d1b410b0c8d77737389531a8f1453aff9d6d37c266b0bac211f082935e2fc41e7cae97cebc5f39da19a17d25da7188b7bd876ba0bb766b70fab7f5abe5c185aa3b29e9c5a0b2aae9fb8990fbea2f4b3d11f6cc2f70dcafa0c8e88b39437e4513855363dc9743d3a1e15ed4d7646f5c9665e8687ca52912becc96dfedc05eb75b01cccb9e9679380becc9aa1d10b9aba041e8000d4773aba175a9938dcf1ebf58f8ffbfbed9655d09a07287586e1dec3199f0dc532dcbfdb0366acbe99658f6feee5a96d943fdfac7778fc75e3a3e6eb3c16ef508e2f0f2a1324a3431731482b78114b8ee659d896017e25da9bfbe09a6f959506a8b4b33b670e839a5a3e1bc353f3f4b531a7551abab5a1fb96da373166bda29bfe82c61d324e44a06360b3e59d72f71bc844108c22e7ab04fd510390c9d531d77ca320bbc2c589f8e26ed130c01e6bfdc036c37c5aa6dff959c52d893842b66bda59af86810908208fdcf57639e1806230b5806e30e526be94bd2ae745be870e40e03a3322ad8fffb9ae09faf30f052d84e36c6dac1f33caa6c7a01553c23fbf216e2be632396d5258da3ba71b2cdfa77fac946e0ee4fdabe997c5e374e5a581947cc036d8767ed3a3c32cb2c15fc208dec9d8beb25cecf933c24cfc143a72e5dfc229119873bb9394b6f481945414f5687c2e84eead5daa670c0d11580241e6ecb7ab380c1fe2f846ffb56153cc41c057b1fe6c6a6b21123087ac555d2a689305590107881f4aa1d96d8147eb7612dc5d7d278c079f0348a1440dac9416f7f7d3126288280087af384eb1c19c3ccad870ac7759b77af65628f6c6671c24e12b166881803829fe892ce8da701cd66a71ce86d2bbefe6635f3b73a35307495308b10e147a4e1b744af5e71c33e36ea3019749f88cbbfddae20376d80e2e4f19c24c463215991c072515a9e7b9424059f92be35a3f3cfaa6ce7b301982423c6b447fe18660c16f1c4998479653dfca4364763b7abee91bc7338016fe3c73e855fdddef98d7b17db27ba1c02614052b831fc1cbb18cad6e061915e9b4b0d59719f07382c4c0e76b3038d8ed4ff034e32779f25847a8ceab383a424e753190bbfac3cb230d7fc82ec734d117258b7efb4915ae59c0b8784f6554053cdb18717b4b3c7b41589eeccc3de70f7150ce2797d12b2e83adfb9a257ef8b3077ac6bfc8926ddece50c641427d1590229d419861a8b120753cbe4cffa5381dd21a944048f92911b9a0566beeb990e88aef141248c9bf55c1f8e041fc6fda08a6442af3aae34be46520c632608b84e903245327a1e1d3984c8e6be5cdaf8e675ed391d8536554cee40b4ae491e2116158086d9b6d0861ec45cd5f0c120fc969edc5517933791289e727135053aca0a7b5e3223066b3bfcd8ce3a1e565c3fb507dc449992c046a9d33c36b4389fe827e312d0370c9c2cd53d8184c271547de2b808c25ac559373fee30b285bbc40ab6a9b0136f3e33bcd996678dfceb8e9c176637283072bf328571999e613021e49ee8ed1ef3ea0afa446760d70a6efed172d3c5f7226825fac61d7215a3765d1d4add2e6891b349e5c41ad0865fc61c240b8af840a58f77cb707d7e574aa187e6c8bbf4a58f434da600a26cb86c6df3c0afec38343ef42e4aa8dc4dc435ac26290b07444912d554684d724e850ed89a9711e98d9f11f00ea4175790cd1f98f939adc943f3c9cf354ddf2f3fa8c4f9032eca71f88107d83ceafbe798e8733c376bfa046efdb88d90fb0ecce79f839517e54826233d7241cbcd6af48bb0744780744383bce56e98be501b45c6f4288a655e4fc4d96e0559ea9e0fa91939341afd960c0793ebaef4bcf936eaa22f46a55af7148d608a03caa97002d4a582af6fb7b3ec9221c20b267bf8e5098a30aab4f453ef234206736b69904b7b35a2442df020ca07e28989b00e5d6796d5bfb32dfbd741e5be1691428868ef82479341cd84e8194ce1167bd1feb7ca5349a03d0278e826404e94f0112ef7723c7cb04fecb9d7cfb475905597f9dc7ef9f9dd4e8e4c4ec315a186b9253266244d7005a15b0ab955f1cabd4b35c868f6df0088e9256a281cee2272182128c31dbbaa7d5566cc22b2053cd58bff2dc242158ea3eda1e90707c87c65952b0921d78f405d44b9fec66e0b9aca72162d02f9e1069fa6b473f5cc008994b89d0f21c2787aba2e47901c2b41364411202651e89bd9af38c29c224c29017740bfffec3f9dd66a333671f38e3207f986c13ef917c4f71477c134b183a44359cd1ecbd30466f79f0a7436df1fc9a19b2ef1bf40e840a2cee75e3e4a4321ac4675f6480f1c0643cde3c19b839c34e9fc5e1e644a799461084f12a060fc8730a4fc9888a1362f28ca86563c5cbb15d8f5b5e1ff56924cd6718265237d052efa343187573df076a8bbbcd75e6482122cbc5fd38d35b3e855530977d5f0d2e2898286e63859bd9b2d55024b4fc2f4b1bc0b09c9f256dd1a5f3ad34ca5c250a5be5a8ef21a3ba478d3cdf8bee68c2273da59eec93d815c32ef323841ff1f072f9ec6b34427027d6d6ce682b27dfd25dd27ed4d1cb070da6f810a853ba26f1e04c8abb38faa658141d1fdf96bd12f1b83fcd0ecebd1a9f0f23640990167685bc7bd15b7e9784dcef818d3f02c175f37eb4184817b4ac59e48e47d1494ffef7f6125e92530dd596cc8e79fa79c6205a9c49b617afd582b32c5a25c603ccf0974f10b8f567fa00ead38533b48228dcc0e672ad4a70a65aae6e9b5f08fc71845e7b62a2681d256e0aef2e7b38a2f71c5b78f93c4529415287f96e8eb5cfc4184180a6188e181faf11a675e9d49a96ce84ebb0e59e10b33bb5bdbaba3a252bc44d40051cd2de8c6ecb15d48de65a37913e1a83cd73947b1578b2c6676ff603dc3ac6e5906b7f35ff0f9bc115661180fcb3d88ec33e03c3a5ed6b44752515fd068efa39fa8cb050fe12c72cf3ef247bce0845ce774b91d66d46bceae77a47df566e34d835b04e561e43c746c49a073640b61037d65421136b6abbd9f9fd8f097082c2a75e39929f999050d59f3aa564302ecfa444b38e852d494b8bc6fd14bac757ebe38063fe7bf5439a2213580f490028d4667669559a587cce06dd25ac21ff112039079f9138aefba63a74faf18f7d782051f03b6856d62e5e6a69b7255fd33b8311ddf6620bc0ce152982191b7354d15b7756120ecce2518e58a1fc75cf5c7f3865f67d265c58e7b69e430bdf026b20c3a037715e40d58f97041c8ef97bfcc985ce774e2233f299f6586276feb61dc8e68b6a008298df1f2f0c8ed51dda0b9256d3695477a895398d9bcefed16060e34722b42c330496d672e7d5872185c1463181f52469fa6c094bf81ac955aeae3f74ec8dcaf713401e8d564e7fd50150ba6ad1ed9e5c625bc4491c593ce7fdfa46352bc2249170a57f2542bc36e49c724e3b708e5aa5a083d1de5fe8062ef7872d0284ef1ce4a57c0da9a91136e96be7887f4248c7b8fbc8c0cad58cf1a385ab8722d8430db885b3dc17e24a82fcaedeeb010bf2a1666bfa2523d4d0c5c2227086ed4cad19845cde0d7eaa264fd8ac8817c21faeef77420861bda8f6666c1dc89aa15eb33b62ba03a7b5acee6c2247432d588bac24778c54db6ad5ed057956e4351fefd85fe928fa071407c116b12f2525e6cfaf6194c9217586ea179f090f7adeb5add3eedbe69d463385a981cc3abdbd189ca1c6e9cd3c751d8cd058f8a9a70b3350d52e8a7fedb531df7872f5ecf9949831a73ca8b810770c8ec8db54b12456420f7f1347670afcdb455f310ae622eacb2e380e0ab8064cffe5d4b77f30a198fa897269e37a29e6fb727a9c8b997fc94886ae3a6ded6f0cbee894a86bc989bf0cd1b58a9c216333c0dab796eedce33fd1ad4d90a22f76caf0e8e369602556752a6be17ec5906daf3e898bbef45685b9b5ea8336b9442f3a863d26d7cdd74614fd77a549628504eae559acce9b4e34de40616ca1c94f0e2035714d68823d76dabf9a6606cdaaa98ee072c95c586b9297701fbebf7b6e76c027fb5ab7d964d965124ef70f75e7a2e4496c5f973646ab0468ac42a0be62af084c6180349637cd8349bfd809d5776c99e10bb62dc60456da14ef40ab32825729934a7e128ffba49d9e5131ee2708dcd64f7c799e0e082d6020d83c2c2bfdb1f26c25e11691f50708b4699b49db8265f8ca18ec02582923a5ba06e3984cf566f71b375b52f26c37abec01537a0ab2dc0347249e6421857101f40552821cfd838fe33cdaa78f1d948b27e7a1d9b1ab8b3fc49b5fb988190990d6f2989394dc002a2d913e0c5e21816d1c16180dc5da7e34fa716959d425ed417cd86c1e5448e8a225001f672eafa264dfc823874526afa0a2a7d0f89399a66249437345fe2174db681785ada68ec6b2830bee604e6802a0bc47e5e3340f3bef709730256acb04090e4026c8a102b5489d04b39f5a538ee554a3ce776b5b30c0dd99a8f325faa4c5ee1621ca84e1b287b60b8091bf6789f7b500011b9734594372e6748873b47481162c4650a92bd5cd7449c3fbf5dae17f240cc12b44e1e6b2e53759eb0063119729e436b046314867fd1dd149d53fcd83f7fdaf623bd71caeb937857bcf62b18da4128a894645e0f8264ba77f44903f099c50bea0e89e034a4d6013cb6a34cf1091e60d1710614ea4cbb71f835f350d7d467314ede7ef54f20c9d246e6b382c92cf393ccb760d0be3fa870722d6ab2ab5ff204740b339d61c60f6d573ac2f0796d54313c38b86075072ee77282c7f357c2ee76c3243dd98e34ee05dc44f9608616d18c7decb1937b460bf97d8df212a0d746cc2dda614923c6407333984519125ac0acaf471a376313985a296ce955d693fb4125e87d07488b6364b9b0050eec66c0cc9ad3faca7bb92f2c723be93fa9c25b106718d7f1a6b332766e6ba65d2e870de57b04fa47653856e7ef1c45f1195bf367e8280f97a996980d302f70a37e6996abe81ec69d19a7e8fcd3cfa25e43458be85f3bef773eb1a5559d649a69f3fd160edfb8210c7265659ff9f83f2ae5307af0ef4c55faf2a151a15db66a14011b699bd312179960b4f271ad9bcf0d2c02d807fd0c661e29ca7dfce989035e6f434f4db675cc7cd5c679a723fff76bbf0adbc9a0d86b1c827291826b9c1a53b6654b181fa10a10c9fde9cbbc2950ef8c73329ff08328230357dd2ee9f039e4b2bdf574b6b9b84bec4ef76d0d10f2e6b783369e6f3576cdae095fa9aeb5dfb1704bf837fb0f6524d5101fa8683b3671763d237be28ee8f47908edbc3a68b1061b931add4a8aebb56a151d03ecc4706bb2406fa719d6517be4b6915fc8f9515942978186637d676988ca57764142d045fdf88e35f0b46eb26b95fced3a1d72a4baa71e1dc6cf45b62fdb7e77c3717f22602c54a37c95bc3273b4109b66e3bab603045cf74637be8966bc9926ba913a223de9ae77e3a9a7ca8fbffc2d7bad721efb216678a8fd4a3c9fba45bdb24957fcb6877c2fcb9842c8f0277cd9d79e87ddd3cd03df9589923c4b64a828a19d520ad9d8b83039833c9eb4edef5cc45b5adfb7aaf01f08663d3033a07a1be0a2994c6cad414d2e0a946f572e413368e3f67a662aa4e670c74e88432688b6c33afc1dd7f4877d5a9b43461d51c3f87b266d4afec34879b6616513b10fd1ee33b5cd62baa23ee9d77618577fed44516c6f50673e177d32dd9c6d694705d1fdc1bf7c933f9fa477c6d055c77aa35e4a4c6dff6742ebef5fef23b6b154b2e1a7570885c611d7ecd698400520a3b031a90edd6714540007eaa5f410d33de230a7824450dc5d664f3464542aefcacb825bbf1b3998d40b5d549f2358c8b0434d6823aa4d296ec2b6889e95ed81b8e831b0207224832fcc2ff3de0d347122757a966a8ed8df98943cfb12b1017c83eda6ec4e5ced1949154c202c5857f518f3fd9c8d1a1e47760487b7d54ed1df328705827de4b528719f903922585d70b5ae0e6ff141619fcd31f240e9106c0219c7cd628e39a15c158408d8b8cb0d0fbf155f8bf57b815f03f613595a34ed8894e6dfc600e5db73a83da782ab3ae0f3d95bdcda0f927d70799a5510020b0e7b664c2c9a03d3dfcf1653ea1fa3815de46e56f3fa998b0bcff942fcd23983938dcf90167400891c5e0b0a517b7f7a0ef5549c3b74e0ee65582c10e9d476177601e9dab3e04ef72d6f8c554570745c91cd03ceda27246f2e92629ef1331d565d2440eac5fd39e539ccac13fd564648bcd58686ef865aa77e2354a9cacc0f0fcc2de99eec5923d8f722e96e252b85846d3f7aff3c2f5ad90c54d635ff5fc0173ff237d8b3cee9189dc5b039ab44a2f6dad7754506ce7b177b554ed581626435a360a976a80588b4d4dbea49e6e68de29e14ca40e32d8b1463a94d5043906883bc306c95ea4ebf0b7b8343d10471e8a190a9b3df80a400a10fd9a72ef77855d6de76dd4e032a1d0a56a3df7af4d821b8440b39799e0265f65efd8101efc9dc84c574c3dc1e9134824e27b08148179b2e606e6085d5ca01d8a3788b467df2fdd1a82556ff1bc50b4d163e76a671650b018607d6f4bd4b4bd170850a9e4b463c71fd188e1cf1a20c760c640616c65b2238f4505aae5c9b82bf46b2faa9d3b5ca260ca19979469e3edfac75afe02dde971af93dedcb48513b28ddc532c0d583567534c3f6404a9f49e6c5dcf8b79eaf93cbc020fe5a711764301f4ff46ce551230cc4f03f7f2d730b084a1e255ab4f55d518ca198ad2fe6d17b1e2472efc073e847e6ad0c5780c516e0db6f4068945e1589afed6e8b3fe409759c0f5f8dbcec4e07dbd7d341f8da725377e614d3e2eb789c2e0c7e7eb596f25711fc5589a099a76ef0da88720b8732971ce7785340ea2ade6045e0942e50ae16aa05acae9ab7054a7ce8f91ec59e49edfbaed4bb651804c4f2c2d0c547a61512b32f1ea83398defbda38f9bbb0d29bca149f583098d018faa1dcce884c7d185a5d007905560f04a9c47aae31939580de4c01d6e7eebbd354524e18b71b6268184dc0f8de8d10ff740e4cc7b3501454377f5a096360d885ab0ce84d766c64628c47b02101dc307190f3e22e0480615f4caf6228949d285fed2302d682f6df82faca06100b0d29cd3c142193cded147b120d4d520398c09d91412d650cfa8d40bdbc7b1ee439e1ba989d9be70727dc82420e695b20490225c8d566a2eb19ab7578c99aaf956d883febec078d1994b6892ad99db1eda1fc217ca012afa7594439b271f57bd264a4a6fcb263ffcedfdd40051011c71a911df381b90c3bd8a41adabb580b4207013196328c6419f7f32b4512bdf1ca2e70eccfcb3f918645002597a30e005c7b7bc73dcfabf627702f4f989a0fb82c44086a7fd64b03f5a8d1743167168b2b5b8be74bc4dac1e4af879fa289e4a1a466f5d5e20ce18ced31ec0d69d44fb0ee8304ce3f7a04f413f238cf38c4ddc0daec133b4336f8cc31f7b30d77e4c6ff612355367115175cdc72cbe3c3f6fa00d244e1944f5100d1a1142b542aa6287c4e9d097af5812c364336505591e93f7c0b78741560dae677e5036cdc05525f49e6be885a3f20604126c4172d102e877a606369988be4db554d4c1ae3ac89c6e8c20238d4d6872cf6b6c4142b4c9cdd4f5db8da6d09500a6d5284f3a63c17f9cba432afa9a54024cbc5812b8f8facfd107cc13dd887c61d11f38ed07caa644818b1c4f20ee2113b2f516c67053ed653afa2437f3906908a4d064a6283bdd9f8f9c80cc6521f2891368608754728b5d1b7152188c3c6025d770b2dbd9eefd147944422be053b734f855e407af1757fa6ed326b22a5d881f6208bd1d50df4b3ee79b9bcb4957864e8418cd2a49dd90b140254ed860db612bb85ea72d84812b79e124e2384140697292569cb16db1c37553d82277ddb982cee1adc9926fcef7c8149c4b8f7c7745f24e19a7a0df2ece881eb6560bd3742a43c531826e237e232d41affcbcab032eceb889aefbd0e35121bef9722815afb54dbcccdbaa6ed50712a38f905f1fd54d48ff4104b34112dd181bdce4e33f90d8ffd9e7b8f8ce7b94329b3a6b9adbbbbaad2f7560d2ac51fe155c8a8863d395a9ead129b96344a2342a7ba55105c54857eaae053a982f7a520d2994d70c8c4ea58390dcad09760d6693d1bebc5a61b1f9e4f47d7a8c94ed8a6a89481bcff16e0d00a4e7e17bad2dba7eb411a26889214e147b7d7e276f71c35c843f36245a99a57c30afe70b9ad5117acee9be48b91862da6c11e085ebbd0d55d573f8a3095c7c01e932d217a572dfdc68fe3555a62b414dea91de279622d268a8c27e7f14077169f409a2cc053421e1d38346f315d18f0c6068414779e5ea129f535c1b1d2a6f779eabcfcbcb6083ab906da58deafb8524c69e053378770ade9a04fad9ee4e03884ce4463d42033da98b25c0430a56de4e7a90a39a5569838052c816d779bc4de944361017ddea1c9cb64547e7fdc2c508722253f7b4e6910c4442eec41f8c74cecb3dca7fb140299cd8e34af35dff3b786902dab9b8d8c4f9c5dbfa5a266a79261ba44278b9212a5e16ed52537db31fc560167f8220ec107468c86ff574815d2d494a32a00f411ff3e728dca7ec79d6c17b9174acb78a88d28b9693ca49fbc648f0b8d7914656477670f44e1ba0aebfaf3a86c2e151c7ded66cc501cf123d3c525cca1e1d9e08409296e37eb458f33febbe74beae3dac3b39e185fd875ed2c85357a2ce4d7aa658ec2a606dd589833c96e7af122fe72ac8e48946a312b56bc703ba6113c81e91ac14b3cf0e4d54d515c3a696591de2aab5cc3568b61696771caab99f4af2964e9d878edd1f59afa17ab8cdff91c8c033b4f365e822a69b28a448e7cc8102e7bb6b075ff724afdc19e246d5b401aba34805c15e6bd0e4c9fff8d219361fcb40dc79616fda0953d730545182568bb6ebb1a1807f09f7523166c0580d04f3991513eaa78d042ede0e270504b5984124b9ec221f82b1fea94515ab4a611db0a598a7693d372b8396fe130c7eb40b3b45c3d1ae7781b6facaaa171127c6131aeda1d4a38102701fc68430ad07d901f631d31ffe905654ae409e19b545863db18b6e211bb3bf38f4c0380b069f97961b89faa683bf177d2ecd0e589f427c1b3d3587500dc3c744485626a783f5781ed8f3fe95740bf4b6ba5000d165f943f209ddccecba1db4cee8bff1b556abf1a8a9df1ccb5df6421a1ab2f08c7b467c4900d9d6708a0e332ddfd84938425203f0f20cb122f021023357502da1fd69c8064ea2325682fbe800cb515c9cdfc101206a6d8a3f575b16966217bf8b69d8313ac4c8cec2b017a2dd0624506a8f7e81595e2dcfbf075a06afc56205ba4059209f5faa3e925237155788e623d6f87a59025a9fdaea1fe9fa52aee05cc44c87fd903d2405a91a39c05a00ba317d354b915ec3ebefe43adcfa6853c20378ceedad187ae347601584610b81d14a4093ff78d1b8ff9c061a0c47f8a3d087f94b0d652060da6b86a56a6e9e93af21045b39d81fa9dc7097f77a7ffe4f48456b4a0ea108d66d8714b5f8563e17680486b4b3ef02615d8b03083bba2c6c42b47d178a33c24042953371ccf2c79ee161ad9ebabebe0cc161290d1be167e42bbe99fac31fd5478abd2e78a38f4bcb57d9eceb3e89c6f16aada8d8db573d85a1a9fad8dc7a38b36085cbff4b73376acd7fc8006f1a2d68776fd3477966c99be61946115d8e2ad15d0f1beb97a2cbadbefe4f738007a02ab40bb203a0f2183786d27f9ec363c66c8c537c009e209484e18e787afa68456aaf2f0e15dc3187c6da41d11227ef9b30bb9537341f574e541d8d6f8ec53c8af4b475e96c4b84fc12a91090d4f98e971004a1932d46738e870ac5efcc162955d2ea0a8b5ad7ee3c38cf96d38144ba4f6e8b3817bb6c25fcea8633ae177c87e083b64e474ba14eaf91e946b57c
key = 0xf7d43d2f6a04728792401d7ca0d630f3606959036dab288c336353e1c8bccba2

def split_into_blocks(ciphertext, block_size=32):
    return [int(ciphertext[i:i+block_size], 16) for i in range(0, len(ciphertext), block_size)]


blocks = split_into_blocks(hex(cipher)[2:])

msg = decrypt_cbc(blocks, key)
decoded_text = ''
for byte in msg:
    decoded_text += chr(byte)

print(decoded_text)
import unittest

from mode_operation import encrypt, decrypt


class TestOperatorMode(unittest.TestCase):

    def test_encrypt_ecb(self):
        txt = "Un message secret que personne ne doit lire sauf toi ;-)"
        expected = [110754240720012525258828815870222990281, 139675155146894280829118289779622086138,
                    66591502227653969011769995377961101545, 267730272879788106442758980191606333383,
                    269457615084807651862990667718220059102, 83484251422747171169264274953632210099,
                    83484251422747171169264274953632210099, 172634914289197641512479877871072162441,
                    14887000787365564428826482989182386898, 269457615084807651862990667718220059102,
                    66591502227653969011769995377961101545, 83484251422747171169264274953632210099,
                    269457615084807651862990667718220059102, 11361264977334335007558616878823140859,
                    225138088983263655200948962088688701051, 269457615084807651862990667718220059102,
                    101583710851837410115896438702777244540, 66591502227653969011769995377961101545,
                    276570498493825624464572580236671184441, 273717941691217787852435060469630778627,
                    269457615084807651862990667718220059102, 66591502227653969011769995377961101545,
                    37731770909280726022188745432464469193, 269457615084807651862990667718220059102,
                    225138088983263655200948962088688701051, 83484251422747171169264274953632210099,
                    21425090107841073985194183758445710473, 139675155146894280829118289779622086138,
                    139675155146894280829118289779622086138, 269457615084807651862990667718220059102,
                    66591502227653969011769995377961101545, 139675155146894280829118289779622086138,
                    269457615084807651862990667718220059102, 66591502227653969011769995377961101545,
                    181717521570720024563984175282092239751, 21425090107841073985194183758445710473,
                    11185968605119393903013785436120336422, 101583710851837410115896438702777244540,
                    66591502227653969011769995377961101545, 153405257070096940765375877261414395752,
                    11185968605119393903013785436120336422, 225138088983263655200948962088688701051,
                    269457615084807651862990667718220059102, 66591502227653969011769995377961101545,
                    83484251422747171169264274953632210099, 172634914289197641512479877871072162441,
                    273717941691217787852435060469630778627, 318714543382488791051375047600683142183,
                    66591502227653969011769995377961101545, 101583710851837410115896438702777244540,
                    21425090107841073985194183758445710473, 11185968605119393903013785436120336422,
                    66591502227653969011769995377961101545, 208114640819362463657192215345664659396,
                    329326528551963756917089182728016710412, 246054157448536941894216403024979802907]
        key = 59175378448483159366830979133373343628532096962263744739244943153083052201664
        cipher = encrypt(bytearray(txt, 'utf-8'), key, "ECB")
        assert cipher == expected

    def test_decrypt_ecb(self):
        txt = "Un message secret que personne ne doit lire sauf toi ;-)"
        expected = bytearray(txt, 'utf-8')
        cipher = [110754240720012525258828815870222990281, 139675155146894280829118289779622086138,
                  66591502227653969011769995377961101545, 267730272879788106442758980191606333383,
                  269457615084807651862990667718220059102, 83484251422747171169264274953632210099,
                  83484251422747171169264274953632210099, 172634914289197641512479877871072162441,
                  14887000787365564428826482989182386898, 269457615084807651862990667718220059102,
                  66591502227653969011769995377961101545, 83484251422747171169264274953632210099,
                  269457615084807651862990667718220059102, 11361264977334335007558616878823140859,
                  225138088983263655200948962088688701051, 269457615084807651862990667718220059102,
                  101583710851837410115896438702777244540, 66591502227653969011769995377961101545,
                  276570498493825624464572580236671184441, 273717941691217787852435060469630778627,
                  269457615084807651862990667718220059102, 66591502227653969011769995377961101545,
                  37731770909280726022188745432464469193, 269457615084807651862990667718220059102,
                  225138088983263655200948962088688701051, 83484251422747171169264274953632210099,
                  21425090107841073985194183758445710473, 139675155146894280829118289779622086138,
                  139675155146894280829118289779622086138, 269457615084807651862990667718220059102,
                  66591502227653969011769995377961101545, 139675155146894280829118289779622086138,
                  269457615084807651862990667718220059102, 66591502227653969011769995377961101545,
                  181717521570720024563984175282092239751, 21425090107841073985194183758445710473,
                  11185968605119393903013785436120336422, 101583710851837410115896438702777244540,
                  66591502227653969011769995377961101545, 153405257070096940765375877261414395752,
                  11185968605119393903013785436120336422, 225138088983263655200948962088688701051,
                  269457615084807651862990667718220059102, 66591502227653969011769995377961101545,
                  83484251422747171169264274953632210099, 172634914289197641512479877871072162441,
                  273717941691217787852435060469630778627, 318714543382488791051375047600683142183,
                  66591502227653969011769995377961101545, 101583710851837410115896438702777244540,
                  21425090107841073985194183758445710473, 11185968605119393903013785436120336422,
                  66591502227653969011769995377961101545, 208114640819362463657192215345664659396,
                  329326528551963756917089182728016710412, 246054157448536941894216403024979802907]
        key = 59175378448483159366830979133373343628532096962263744739244943153083052201664
        message = decrypt(cipher, key, "ECB")
        assert expected == bytes(message)

    def test_encrypt_cbc(self):
        txt = "Un message secret que personne ne doit lire sauf toi ;-)"
        key = 59175378448483159366830979133373343628532096962263744739244943153083052201664
        cipher = encrypt(bytearray(txt, 'utf-8'), key, "CBC")
        message = decrypt(cipher, key, "CBC")
        assert txt == str(bytes(message), 'utf-8')

    def test_decrypt_cbc(self):
        txt = ("Es-tu capable de décoder correctement ce message ? Si tu lis ceci, c'est que la réponse est oui... "
               "Ceci est un exemple de message totalement inutile !")
        expected = bytearray(txt, 'utf-8')
        cipher = [229812406910754622705329195568575238785, 250803163711434548366605235919211999431,
                  301809623156173522019920630340971431027, 208881671879821999087006557648685635345,
                  36013514959706779414591016057607509144, 50524532277093378808577296726932769591,
                  49175152443955614718912257917249926142, 173620665296848308441196702765241331234,
                  92810878039765750054367922275011377853, 143908268177451368709805915813851441896,
                  124974543019009088390614938657092387256, 101835779723333462309016770880126512706,
                  328247520520620071589414768372415822641, 215025099937863849237171568217431387762,
                  15601400898182397940804677834608383885, 42875284367189368905804496322033098264,
                  88113256535680107991412430819134868771, 303142013907303972383765078369181686368,
                  223507970262736104618195090343200892629, 303718983009473256514262688385581658522,
                  174613810138009433525985543742061094604, 252745879757554394880070088593501750573,
                  282226731856077571307469780277725028872, 212205717818744761046319616526904589791,
                  105265202833759444466828535284040199346, 322249956375927720779373604723661989417,
                  34566798094516343434113382008363067748, 16529946306881821870203328666243693128,
                  139614107512915319936248873397368345898, 308522685963917366080477308424114187473,
                  202259001339119826520750447550645731786, 46823457654095667331064318149214765303,
                  304362304774179379027276847963319310593, 310285724433984962182826115661048121100,
                  61977511195063305545640932305480609473, 302253834902071015005222029488255463528,
                  255748633907967506198425262289755439522, 134679335929958019356416162089978558849,
                  337994425516736801230510089039215334936, 230108926801705489521112691898821638464,
                  127321577063266759714535756474056478453, 14795199665063865731064481756601830460,
                  206790177631987541441637036890459114161, 167136852175960022662628583127040439718,
                  80360073675078148062844486777474397651, 255146673976998720462623906815050638844,
                  308626209083149201797587339114472049212, 128421479788885545707482816073265884213,
                  80357266125934426313181821878666518914, 96273402128161563285642041671803824789,
                  48014728977779762361709235121097541613, 93355618775164691433634080341745205589,
                  147182630478394576003892756560418318637, 202821401391362639450790364480480600025,
                  48707855232438863608002579342787765242, 84140910210854877535164422500367138332,
                  160857932679410241997471084698830443452, 77255785906793107975362393074133626462,
                  84771878685311279136300930328997419322, 193700485028470779340306918597488855519,
                  280257920623270094548527749543377201799, 140756868911257460929288534415073699162,
                  337423047358288043553865754616156161389, 337754664654347383783883446735353431773,
                  5828491652241016055825458664630715149, 284532874021656584395435660314458736790,
                  148878661269537161645631625296865295861, 136459470220415378361261300112281284886,
                  139571934337433981773189552908638211441, 189744093544758427567080283552059340382,
                  168803502603172526669260302077281183949, 216428445264072348883788807754459788058,
                  289376796016904580965756982420060458758, 314242116327715698251760246145393201105,
                  268946284452139654047838649277907157147, 191392244344199209130509862240838961411,
                  96484222349732400006552729503089286637, 221685834197022390228548790900108909308,
                  108207780573694811879054541392769036755, 75352774795134195776201023351101539866,
                  110123036565719877997489500819331478919, 108339896096451638943550466351165319524,
                  94429942413654552818850146369538339043, 130727122869998553278670743817896993153,
                  280056869403190898512711067831882012235, 177891579411655890494463770599545005111,
                  206640407995850361738663388806180064078, 139532561701730800225377152448722288868,
                  301045882640331955825861889047257286806, 102853049410060238038172559766549493019,
                  305800970105701883105905096324758973280, 259888390594264562756852148591865334155,
                  214711065029581738050901531251667119970, 68960324735737056133777513876500116602,
                  259699363752756760019527900291441454085, 14921421317986603611991839141723080330,
                  192133630521697855755401558590230998637, 89845690995337698548132482749650813731,
                  247225781448411419028207294909190432545, 224830518909752323324467595951203345068,
                  62654980790266691530088891775161302970, 90078048473338380632033833854557296257,
                  213558927801293429021060217629681579813, 331280783334787622969630050975493518184,
                  17153171049701333110457879046808484799, 199944744791249730116796542433659124917,
                  49727129582182859281344001267728913199, 267971425016484852031706826654085007382,
                  176016413215356386914038653581391993829, 27160414193159924400125848460467211446,
                  5034192066517836795263368100474848382, 39963935454846826888810769236983283007,
                  55380204582635539225263904402056231931, 195349467974019445171438593446160587791,
                  294851432866446871547830717331662092326, 228357851208172812477718406614399164473,
                  125658483471972734368711416953403119000, 251434728125561794975763102368006678161,
                  195657651161205272183930292362364545583, 66756127967227405624788867563231587126,
                  65471193041790942005244425529710417831, 225741044876639988129420281453528472625,
                  217118607407043365600778575313362993132, 141254824242236515903415081351653033457,
                  303803986052267682784694625424631914998, 299857224940832617183008526383991729504,
                  34119659403627841983549874832066974499, 183503923634043503034007925911754466223,
                  233746008148471429091517356392743653744, 278123859204468000732269219165554120887,
                  109037336973142493971485663656883960682, 65666447027746360593734154508986868229,
                  160071049831880256390642784241374430664, 3152170765250754036270263213628002668,
                  26518572349491390563647920197991556770, 149382167743838067704709119275985965807,
                  129743661629611971758505523842437191804, 274602359070131993795632276782216419300,
                  21644186989191789386024884271716373730, 41972896565814824516853578450284262138,
                  314625865779602659232413181111466245824, 173379665790990679890995787111807230317,
                  86628906673229954408267323239010537066, 115072648243133029748621607032707785379,
                  72261087082606280036785478302227306263, 253057140273476567603611278477055164779,
                  333845510470122719803815281567255901887, 294721698306714438166427460451384074111,
                  251976210494713678310308531198511429582, 334195689052876887735726220699884566863,
                  58747440190111549284803715071487229925, 206931454474747950652793280615000200520,
                  205774703505969075086715144935065842540]
        key = 2074038311066901704458280453016374652262928663593769232443771776310965583625
        message = decrypt(cipher, key, "CBC")
        assert expected == bytes(message)

    def test_encrypt_ofb(self):
        """ OK """
        txt = ("Es-tu capable de décoder correctement ce message ? Si tu lis ceci, c'est que la réponse est oui... "
               "Ceci est un exemple de message totalement inutile !")
        key = 37519486209173462958427189313567354829147036682875360254074980216219547659347
        cipher = encrypt(bytearray(txt, 'utf-8'), key, "OFB")
        print(cipher)
        message = decrypt(cipher, key, "OFB")
        rs = str(bytes(message), "utf-8")
        print(rs)
        assert txt == str(bytes(message), 'utf-8')

    def test_decrypt_ofb(self):
        """ OK """
        txt = ("Es-tu capable de décoder correctement ce message ? Si tu lis ceci, c'est que la réponse est oui... "
               "Ceci est un exemple de message totalement inutile !")
        expected = bytearray(txt, 'utf-8')
        cipher = [67576776898353923663207257848961830011, 322434981677754343867852801697427451941, 247398392961150546577655803126686098810, 109068564684033898100670650370028990841, 73366168659134875085319659225159153854, 196252929524120450542688757379242388040, 278695485430833915815862347607329442080, 229150644978047508516437145820749086763, 291501405312941115361719371637725041089, 65782551952030597809564950731938241067, 315060273456049869592413670185120609852, 64586899206728663023708912816262699081, 39666353140590691067144670105204731081, 296270439546358911622302420889603588180, 52473812195951398975171155155037757039, 183319892823619432787373591797848119751, 56151651113440360642941174543515167175, 329345038839814455944685195716659582676, 252334451635181359152776362820583809895, 322526998807263084459284328912956669332, 223935154921810866910074719762833162315, 328125801792585557163163330512945445389, 11541699061305962170760194632452025200, 76122157114793287597773331684690686249, 123485409700404132943236452537877271645, 35444041292662223959976607788412511112, 150253088823663552007182078905477090427, 135143761768334790852411521770619580557, 101035791634374294309308900946067519283, 193953151501610575467598684660834475302, 180758587929042803038399290150980804871, 294241503106907452898534405696375552975, 126853108308987347355000375576333053598, 62574669746292790852337018277810752594, 215853703090594645141820462968327065230, 290389420232893572393182077903318114393, 66732999579822126958977635568717090463, 116988969454161051713172890550630894100, 229230643728361336272232283507730371872, 255047270451179723504203308035839540757, 198878204506810030943075914715497464298, 233366009308102265576727075062000296857, 58541842819369028952224992046040585374, 86374353812169281793026513640857829489, 98526557144091889757191180763023577949, 141779630641637959094199198251470544338, 30972983461959776987201192467346100320, 33831549399084284985003426607006234916, 218469790653278703796104615600433427794, 108951817518922474613265596989089848482, 11252960586244997057578385874408555028, 319301957082632993041201530900716002203, 295241487744420589578709521845955953489, 115113035878954558500458178824020417736, 137738446481999789004518563004792134639, 196084066290560998754701140037083382065, 276810775171343332154513104189340128346, 60830833898946918775107853664211958835, 8469556137085545487201290317531655817, 289761905753776965528839974856764436526, 307596554060273333640954504791623367872, 70167608316215339518930600045468379374, 34484257929533017203108211934337099982, 223121402884998484117788165703072210257, 291385573566964561309233748164875256370, 234644676669222015749434263904033655634, 83675386273370957291164508499906951179, 162247583179126426478006761172341480106, 173565792221119836997215229989557241211, 141536540332550969422921731814895083745, 303460974992059910875444292954095331308, 223344215566883127742968825152830349280, 99973762749980603495254505421057349837, 64529258513381968809494245167204280618, 189072000710753726011545295024720127380, 30160040068149088850430197887819174861, 103211733056280499498025822115774996202, 88051563762519006071614963601136848284, 276914320296620053009582989834741266209, 10582215030340097285201400728845673957, 85125336480542161044089921289926815840, 303773572002565954959832959683778207680, 280943828828751404221399354042177236056, 50235445537401666454843611069134506882, 308235989331602929355590750113603818334, 101208009842303254329440042119910864930, 104178288837176231813600804186493772180, 43513797083908126126631739419230608769, 7109046261494465711446485466457257782, 8610590136547413944522439628865404553, 157513619129885787731599180795430341720, 67220699190618451230201963728214982404, 184880647557436974270015721229063431764, 152749643767321514061377788849773669125, 292944725670072693567256232270230706576, 40348821753908888154383605115962213896, 194773291883210447141248802452284204649, 74897289377092692824258993082210910953, 292652467194434182663085007079331188515, 106774914568805420556680907033701946194, 89704276657107461236987827022422662447, 312072449293822948238077062695411008154, 203098795186880765357859889345513059517, 139689515635670471215287101023328184985, 285217359244330792743656306208684916972, 287918447945071430460275027895439832480, 153636980081586027044086997806835852701, 179416530644125674857980259633189100052, 82221934011746432119137583364742123462, 178141871125469819709303136649227313697, 156387154962587402326398296655362692605, 14649906927957317356994005087942708483, 294162413420152466807368022250855022034, 304006003418722492039118365169909253711, 267898653732031774787619074246696410971, 315207380146481045238008039659845041096, 132584013452860053264458657324209707786, 20395815879151623846112588574545410294, 194478399438567449485988696535508629023, 239036306874838213500159839139314775001, 301792627827396972246101368573204447917, 139327364775876152083830875899286952255, 11595520096969419545672712971237307609, 187952436288041041645986380842453792352, 79546412948597715588456778165779472993, 275953959606287330457318246980367322188, 334527004263843671236295075637371657832, 317344436995512437398028280927291901323, 74006107104850422391774950069141913689, 189735348597701086622083814113706544176, 74218393950152434091602346979768195840, 241374808957655105264115168194833133180, 209514473456894844514799568825196278897, 276762214512861866842016793886404170410, 174301023920733779918558249070045116204, 45752394291446536102031568672561912310, 65547786977986176224139839641457920238, 142008750120702369964303236482522138405, 233788537626149408981984047281149411254, 208661321507940505250451443408019492302, 231595417222507219248533162351610704103, 205142025431081449473650179185866003462, 41523786040387537070850277307896993637, 69104801219258581901122200952494527324, 289073405171629133074434833490254212469, 68608407764861223157395296252487093402, 257334840867639196283436183758459751952, 252466841947269615681012641054648643807, 125587298389568209545164159790428046365, 11030574173884750242072058982710634778, 68512491988260041925077831800763024128, 147846382627403689549661737977329716171, 33460958210474861881589063823906942934]
        key = 37519486209173462958427189313567354829147036682875360254074980216219547659347
        message = decrypt(cipher, key, "OFB")
        print(str(bytes(message)), "utf-8")
        assert expected == bytes(message)

    def test_encrypt_pcbc(self):
        """ OK """
        txt = "Un message secret que personne ne doit lire sauf toi ;-)"
        key = 37519486209173462958427189313567354829147036682875360254074980216219547659347
        cipher = encrypt(bytearray(txt, 'utf-8'), key, "PCBC")
        print(cipher)
        message = decrypt(cipher, key, "PCBC")
        rs = str(bytes(message), "utf-8")
        print(rs)
        assert txt == str(bytes(message), 'utf-8')

    def test_decrypt_pcbc(self):
        """ OK """
        txt = ("Es-tu capable de décoder correctement ce message ? Si tu lis ceci, c'est que la réponse est oui... "
               "Ceci est un exemple de message totalement inutile !")
        expected = bytearray(txt, 'utf-8')
        cipher = [111636584422601144259378742167148247040, 167150997998323238592061996334911620946, 182552827894241760979077644115415064177, 86542826853190638752875184093933138220, 237364994653326011932791643908199585659, 280044268619708513463992504104218100288, 152566043610713360529581665702326686428, 206999051950619377848097523166459567742, 180385492571652429675395708466372459279, 22713218005515617772146376692968996828, 201095519737366129370627655345451297973, 31563060562357859343705533874759833752, 279058233573599675604838478806956905131, 40620316410162526331101831731856533104, 302835460911658553222675924723500035214, 232570653218568766596894514935107413273, 36913262025870922881774893376694429785, 150820443959948582184569212974072344305, 207892090996109907673792160907893689198, 84208073056049999314235483670430531878, 144539981209140148549101729894321531819, 220433252001046898143130657680493987669, 62005105817429491021212926374481879981, 100314970650091508069589523251593198421, 108429789990684716825351816218035928589, 295183545800553828271188147328601276714, 173883403903384898704175545114703663992, 197461298026328746494049516603316115705, 142358336189407780615319092136258402302, 186321951085261136916876009278763402650, 295052322140965180759688514561844102721, 157770305700204991252852436245761732683, 88084978038057259251279475255491380234, 267076366135442629987130767530111060328, 147018937731396173743987082223258381548, 298982159663253168853083517526825001655, 338246950288739583888073151874458263736, 230332782034437122729636109004890105995, 321591122204013122167147204487064492215, 318753243172484040562058559900970131202, 218956922786945758109403430681490826872, 269076934465773978200186418546040442818, 50187319998916304188993018879769484294, 72940223115067087300164500741174185843, 95019518366196807222372734579729670823, 185029492088833936633006418840834414222, 301792145104264323839002860448358870616, 250353247665314598089147201739020462175, 6160021629132160820291049797357547857, 334219696741005755587754597186353321366, 124431942963267495590101023854654753830, 85252188891698697982970769913935907980, 68331313485520324394073043878612517727, 306116452438289221668141083194202140247, 52336078710822212360407923945703338761, 63240681781175517980686415643726486326, 331922853093580587907726069838839460399, 330140045974447782232857660964732427902, 200396779140452012261431506030565057314, 226760522228098715756816842805611887533, 301270034239986843490343548854308051698, 225668320970450635207188607965725217153, 139465942692185525658812450692390524085, 198413053490814988565124469025679104556, 306291682591835811885184768131661205081, 87528108714965038976794470284637430875, 264769352381914104283028908477509823769, 185447020590197876667311232733148944855, 11535849624117716741326555149360039842, 34272056929842083460649635150522746436, 94633207602727848147184489294846592950, 79075090436645637130699570129683119595, 153434430897200378556242700093149304786, 45000443518753302947835979375911995763, 283596697287645024029574026866763101809, 307228094432635216214650665952790267278, 76719807336879793509851958298570401888, 333308121170744761074670428286364255808, 85602236166900308348116557801212548657, 95703294396129543666104521907105292192, 27285411654195496294119231572810512983, 209536267274765985117460797078540897601, 142813898570101333682679845112640248663, 264584900879269205315013672951758192305, 109920324597912593908718481441746225457, 73914317696195377688813396147593215606, 323319574844981712111268968930673223741, 57347954532975611616744349882282688432, 284417610539495674212006536536841604100, 217918486662402376648929753414172902125, 137435456394391963549725423573685581129, 287117389272913009414894699919728950629, 82778978412939896686167805851266595246, 289366949686726514598015919976085910703, 191670299607588007596179491318107597708, 186695067190110694656346657049642075122, 255048883876412968833759430410684240758, 317245253876203579587257850950798207779, 179125660367790411271357033963314243591, 116325996848606296917022373049264247440, 281878063407324511124591002844726158568, 9818852706400899100215475437704902751, 104991934668835664921440782355237192738, 149893370637693038759935373527379030593, 256823742771109327415512099719143260832, 277508208464986729308119576922996679385, 56037419508369349334712578843178139610, 56160274205094718249248020018755778101, 274653165070664541730598571079783267107, 120243633265855519534796040746457835317, 59630744190281168002945038216293504818, 139453962491978125542499262210800384885, 12250605315495100913484723325693377442, 198484927481114271605638412782695049404, 96434527580047579214283560586759209255, 25654921395479037538641599631994146916, 287987764880861972513949003296488365970, 276068549819880646264025707181659334342, 60693840017835798823825167511914887954, 328538047114375794008001668637788552924, 198769214452362144762830215012284485846, 22215297971180351195418195017457509248, 37534698286369168270957994388529601837, 203798573025753101255247961434226006562, 337778685977906224817012083506782429599, 73504215454569596215544600673075035677, 149802542845815241475215038193001844533, 87267833178639451672058103294696859668, 62199998939133709681860639138204966929, 103381886638937493439416294836910230825, 197406614866087847549681237455189962796, 271793545603744332230492355888542280536, 187510285848838358454655884559736870709, 335304441775976344511793034429705116509, 296442494782771708387192966664775486527, 214494597329570865900973851159813123634, 281968645334598233341564337249863437553, 231900311336847735300955771234837563954, 6805170168126213490751004984777282882, 15249982366647480517515124170102457652, 231913839587019963152773250950377852994, 54318315231674576105944730097122428869, 23816534916426976176538288080377419579, 265045339640082956390813024354574961485, 61408948266696946677741228862147050163, 207760129116943542930769483331059110812, 69193541806052363783681524962577267579, 31636702964776532418048363816114385528, 200982561880783616650953152633456654548, 204746063933960652068691592993028788425, 112233296323439276941873206136091027742, 247388034879191617219919029482775170336, 118748363721259813662756299632916813216]
        key = 37519486209173462958427189313567354829147036682875360254074980216219547659347
        message = decrypt(cipher, key, "PCBC")
        rs = str(bytes(message), "utf-8")
        print(rs)
        assert expected == bytes(message)
